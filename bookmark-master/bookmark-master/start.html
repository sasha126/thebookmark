<!doctype html>
<html>
    <head>
        <title>
            The Bookmark Test Suite
        </title>

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
        <style>

            .card {
                /* Add shadows to create the "card" effect */
                box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
                transition: 0.3s;
                min-height: 200px;
                vertical-align: middle;
            }

            /* On mouse-over, add a deeper shadow */
            .card:hover {
                box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
            }

            input, button{
                margin:5px;
                padding:10px;
                padding-left: 20px;
                padding-right: 20px;
                border-width: 0px;
                border-radius: 10px;
            }

            .container{
                padding:40px;
            }

            .outline{
                transform: scale(.9);
                background:white;
                opacity: .8;

                -webkit-transition: all 0.5s ease-in-out;
                -moz-transition: all 0.5s ease-in-out;
                -ms-transition: all 0.5s ease-in-out;
                -o-transition: all 0.5s ease-in-out;
            }

            .outline.nofade{
                opacity: 1;
            }

            .outline:hover{
                transform: scale(.95);
                opacity: 1;
                z-index: 1;

                -webkit-transition: all 0.5s ease-in-out;
                -moz-transition: all 0.5s ease-in-out;
                -ms-transition: all 0.5s ease-in-out;
                -o-transition: all 0.5s ease-in-out;
            }

        </style>
    </head>

    <body style="text-align: center;">

        <div class="outline nofade">
            <div class="card">
                <div class="container">
                    <h1> Test Suite </h1>
                    <br/>
                    <img width="120px" src="logo.png"/>
                </div>
            </div>
        </div>

        <div class="outline">
            <div class="card" style="background-color: #90A4AE">
                <div class="container">
                    <h1> Message from Processing Backend: </h1>
                    <br/>
                    <div style="border-width: 0px; padding:10px; border-radius: 10px; font-size: 12pt; background-color: white; min-height: 200px;" id="message">
                        Test Suite for TheBookmark. <br/>
                        Developed by Team ANS <br/><br/>
                        Messages from the server will be displayed in this textbox 
                    </div>
                    <br/>
                    <button id="samplebutton" onclick="resetMessage()" >
                        Reset
                    </button>
                    <button id="samplebutton" onclick="clearDB()" >
                        Clear Database
                    </button>
                </div>
            </div>
        </div>
        
        
        <div class="outline">
            <div class="card" style="background-color: #60ad5e;">
                <div class="container">
                    <h2> Test Endpoint </h2>
                    <br/>
                    <button id="samplebutton" onclick="sampleButton()" >
                        Test Backend
                    </button>
                </div>
            </div>
        </div>

        <div class="outline">
            <div class="card" style="background-color: #FFC107;">
                <div class="container">
                    <h2> Sign Up </h2>
                    <br/>
                    <input id="signupuname" placeholder="Enter your username here"/>
                    <br/>
                    <input id="signuppass" type="password" placeholder="Enter password"/>
                    <br/>
                    <button id="signupbutton" onclick="signup()" >
                        Sign Up
                    </button>
                </div>
            </div>
        </div>

        <div class="outline">
            <div class="card" style="background-color: #FFC107;">
                <div class="container">
                    <h2> Sign In </h2>
                    <br/>
                    <input id="signinuname" placeholder="Enter your username here"/>
                    <br/>
                    <input id="signinpass" type="password" placeholder="Enter password"/>
                    <br/>
                    <button id="signinbutton" onclick="signin()" >
                        Sign In
                    </button>
                </div>
            </div>
        </div>

        <div class="outline">
            <div class="card" style="background-color: #FFC107;">
                <div class="container">
                    <h2> Video Input to TheBookmark </h2>
                    <br/>
                    
                    <center>
                        <input style="margin-left: 80px;" type="file" id="video" >                    <br/>
                    </center>
                    <hr>
                    <button id="signinbutton" onclick="submitVideo()" >
                        Submit Video
                    </button>
                </div>
            </div>
        </div>


   
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        
        <script> 

            var loggedinuser = "";

            host = "http://192.168.1.36:5000"
            textbox = document.getElementById("message");

            
            function resetMessage(){
                message.innerHTML = "Test Suite for TheBookmark. <br/> Developed by Team ANS <br/> <br/> Messages from the server will be displayed in this textbox ";
            }

            function sampleButton(){
                axios.get(
                        host
                    ).then(response =>{
                        message.innerHTML = response.data;
                    }).catch(error=>console.error(error));
            }

            function clearDB(){
                if(confirm("This operation will clear the entire database\nDo you stil want to continue: ")){
                    axios.get(host+'/deleteAllUsers'
                        ).then(response=>{
                            message.innerHTML = response.data;
                            msg = "";
                            console.log(response.data);
                            msg += "<b> Login Status</b>: " + response.data['status'];
                            msg += "<br/> <b> Reason</b>: " + response.data['message'];
                            message.innerHTML = msg;
                        }).catch(error=>console.error(error));
                }
            }


            function signup(){
                uname = document.getElementById("signupuname").value;
                pass = document.getElementById("signuppass").value;

                loggedinuser = "";

                if(uname=="" || pass==""){
                    message.innerHTML = "Fields cannot be blank!"
                    window.alert("Please enter username/password");
                    return false;
                }

                axios.post(host+'/signup', {
                    "username" : uname,
                    "password" : pass
                }).then(response=>{
                    msg = "";
                    console.log(response.data);
                    msg += "<b> Sign Up Status</b>: " + response.data['status'];
                    msg += "<br/> <b> Reason</b>: " + response.data['message'];
                    message.innerHTML = msg;
                }).catch(error=>console.error(error));
            }

            function signin(){
                uname = document.getElementById("signinuname").value;
                pass = document.getElementById("signinpass").value;

                loggedinuser = "";

                if(uname=="" || pass==""){
                    message.innerHTML = "Fields cannot be blank!"
                    window.alert("Please enter username/password");
                    return false;
                }

                axios.post(host+'/signin', {
                    "username" : uname,
                    "password" : pass
                }).then(response=>{
                    msg = "";
                    console.log(response.data);
                    msg += "<b> Login Status</b>: " + response.data['status'];
                    msg += "<br/> <b> Reason</b>: " + response.data['message'];
                    message.innerHTML = msg;
                    if(response.data['status']=="Success"){
                        loggedinuser = uname;
                    }
                    else{
                        loggedinuser = "";
                    }
                }).catch(error=>console.error(error));
            }

            function submitVideo(){
                if(loggedinuser==""){
                    window.alert("No user is currently logged in!\nYou must be signed-in to use our services");
                    return;
                }

                v = document.getElementById("video");
                vfile = v.files[0];
                console.log(vfile);

                var formData = new FormData();
                formData.append("video", vfile);
                formData.append("username", loggedinuser);

                axios.post(host+'/receiveVideo', formData, {headers : {'Content-Type':'multipart/form-data'}}
                ).then(response=>{
                    msg = "";
                    console.log(response.data);
                    msg += "<b> Login Status</b>: " + response.data['status'];
                    msg += "<br/> <b> Reason</b>: " + response.data['message'];
                    message.innerHTML = msg;
                    if(response.data['status']=="Success"){
                        loggedinuser = uname;
                    }
                    else{
                        loggedinuser = "";
                    }
                }).catch(error=>console.error(error));

            }
        </script>
    </body>
</html>